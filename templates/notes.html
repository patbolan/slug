<!DOCTYPE html>
<html>
<head>
    <title>Note for {{ subject_name }}{% if study_name %} / {{ study_name }}{% endif %}</title>
</head>
<body>
    <header>
        <a href="{{ url_for('index') }}">Home</a>, 
        <a href="{{ url_for('subjects') }}">Subjects</a>, 
        <a href="{{ url_for('studies') }}">Studies</a>, 
        {% if study_name %}
            <a href="{{ url_for('study', subject_name=subject_name, study_name=study_name) }}">Back to Study</a>
        {% else %}
            <a href="{{ url_for('subject', subject_name=subject_name) }}">Back to Subject</a>
        {% endif %}
    </header>

    {% if study_name %}
        <h1>Note for Study {{ subject_name }} / {{ study_name }}</h1>
    {% else %}
        <h1>Note for Subject {{ subject_name }}</h1>
    {% endif %}
    <!-- <h1>Note for {{ subject_name }}{% if study_name %} / {{ study_name }}{% endif %}</h1> -->

    <h2>Current Note Text</h2>
    <p><pre>{{ notes }}</pre></p>

    <h2>Edit Note Text</h2>
    <form method="POST">
        <textarea name="notes" rows="10" cols="80">{{ notes }}</textarea>
        <br>
        <button type="submit">Save</button>
    </form>

    <!-- No need for blank notes
    <h2>Create Blank Note</h2>
    <form method="POST" action="{% if study_name %}{{ url_for('study_note', subject_name=subject_name, study_name=study_name) }}{% else %}{{ url_for('subject_note', subject_name=subject_name) }}{% endif %}">
        <input type="hidden" name="_method" value="PUT">
        <button type="submit">Create notes.txt</button>
    </form> -->

    <h2>Delete Note</h2>
    <button onclick="deleteNote()">Delete notes.txt</button>

    <script>
    function deleteNote() {
        fetch("{% if study_name %}{{ url_for('study_note', subject_name=subject_name, study_name=study_name) }}{% else %}{{ url_for('subject_note', subject_name=subject_name) }}{% endif %}", {
            method: "DELETE"
        }).then(response => {
            if (response.ok) {
                location.reload();
            } else {
                alert("Failed to delete note.");
            }
        });
    }
    </script>
</body>
</html>